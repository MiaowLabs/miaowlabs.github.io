# 电机驱动电路

在设计电机驱动电路前，要考虑一些问题：

> 功能方面
>> + 电机是单向转动还是双向转动？
>>> 对于单向的电机驱动，通常用一个大功率三极管或场效应管直接带动电机。当电机需要双向转动时，可以使用由四个功率元件组成的H桥电路。
>> + 需不需要调速？
>>> 如果需要调速，可以使用三极管，场效应管等开关元件实现脉冲宽度调制（PWM）调速。

> 性能方面
>> + 输出电流和电压范围。
>>> 这两个参数决定着驱动电路能驱动多大功率的电机。
>> + 效率。
>>> 高的效率不仅意味着节省电源，也会减少驱动电路的发热。
>> + 对电源的影响。
>>> 大的电流可能导致地线电位浮动。
>> + 可靠性。
>>> 电机驱动电路应该尽可能做到，无论加上何种控制信号，何种无源负载，电路都是安全的。

> 在《电机及电机选型》一节中，我着重讲解了如何估算关键参数，进行电机选型的过程。迫于市面没有合适的电机的无奈，我只有对现有电机进行改良设计。最终，我设计出一款适合带动小负载的带编码器直流减速电机——TTM1，并应用在小霸王Lite两轮自平衡小车项目中。

在《电机及电机选型》一节中，确定了项目使用的电机型号为TTM1。我们可以根据电机型号和参数来设计合适的电机驱动电路。

> TTM1直流减速电机的主要参数如下：
>> + 额定电压6v
>> + 最大电流2a
>> + 最大转速196rpm（在6v电压时）
>> + 额定扭矩0.5kgf.cm
>> + 带有单相线数为1920线的AB相编码器
>> + 带有电磁干扰（EMI）滤波器

另外，因为两轮自平衡小车是一种“两轮共轴、独立驱动”的机器人，需要使用两个独立工作的电机，在运行过程中通过电机的正反转来维持车体的平衡和控速。所以，在小霸王Lite项目中，需要使用两组H桥电机驱动电路。

考虑到使用分离元件搭建电机驱动电路，过程比较复杂，难度比较大。而电机驱动芯片是将电机驱动电路封装起来的芯片，使用简单，安全可靠，利用它可以与主处理器、电机和增量型编码器构成一个完整的运动控制系统。在综合对比市面上常见的电机驱动芯片后，小霸王Lite项目最终确定使用东芝半导体的电机驱动芯片——TB6612FNG。

> 
TB6612FNG是一款双直流电机驱动芯片（Driver IC for Dual DC motor）。关键特性：
>> + 驱动电压：≤15V
>> + 输出电流：1.2A（连续）/ 3.2A（峰值）
>> + 工作模式：支持正转/反转/刹车/停止四种模式
>> + 封装尺寸：SSOP24，0.65mm引脚间距

<div align=center>![](/img/2018-10-04_165328.png)
TB6612FNG内部框图

从内部框图中看到芯片内部集成了两个H桥电路，每个H桥都有一个独立的控制逻辑单元，每个控制逻辑单元由一个PWM信号和两个输入信号（IN1和IN2）控制。

<div align=center>![](/img/2018-10-04_170713.png)
控制逻辑真值表

从规格书中可以找到典型应用电路图。

<div align=center>![](/img/2018-10-04_165955.png)<br>
典型应用电路图
 
参考典型应用电路图，设计出电机驱动模块电路图。
