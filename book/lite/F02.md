# 直立行走任务分解

两轮自平衡小车（下面简称“平衡小车”或“小车”）在直立的状态下以两个轮子着地进行运动。相比三轮小车或四轮小车等多个轮子着地的物理稳定状态，两轮自平衡小车的控制任务更为复杂。

为了能够方便找到解决问题的办法，首先将复杂的问题分解成简单的问题进行讨论。在小霸王Lite设计方案中，假设维持平衡小车直立、运行的动力都来自于小车的两个着地轮。着地轮转动由两个直流电机驱动。因此从控制角度来看，平衡小车作为一个控制对象，它的控制输入量是两个电机的转动速度。平衡小车运动控制任务可以分解成以下三个基本控制任务：

1. 平衡控制任务：通过控制两个电机正反向运动保持车模直立平衡状态；
2. 速度控制任务：通过调节小车的倾角来实现速度控制。实际上，最后还是演变成通过控制电机的转速来实现车轮速度的控制。
3. 方向控制任务：通过控制两个电机之间的转动差速实现小车转向控制。

以上三个任务最终都是通过控制小车的两个驱动电机完成的。可以假设小车的电机可以虚拟地拆解成三个不同功能的驱动电机，它们同轴相连，分别控制车模的直立平衡、前进行走、左右方向。 

在实际控制中，是将控制小车直立、速度和方向的控制信号叠加在一起加在电机上。而直流电机的力矩最终来自于电机驱动电压产生的电流，因此只要电机处于线性状态就可以同时完成上面两个任务。值得注意的一个有趣地方是，两轮自平衡小车的速度控制是个正反馈，最终演变成通过调节小车车体倾角来完成的。小车车体不同的倾角会引起小车的加减速，从而达到对于速度的控制。这部分后面再详细阐述。

三个分解后的任务各自独立进行控制。由于最终都是对同一个控制对象（电机）进行控制，所以它们之间存在着耦合。为了方便分析，在分析其中之一时，假设其它控制对象都已经达到稳定。比如在速度控制时，需要小车已经能够保持直立控制；在方向控制的时候，需要小车能够保持平衡和速度恒定。

在上述三个任务中，保持小车直立是关键。由于小车同时受到三种控制的影响，从小车直立控制的角度来看，其它两个控制就成为它的干扰。因此对小车速度、方向的控制应该尽量保持平滑，以减少对于平衡控制的干扰。
 
下面分别讨论车模任务分解的三个控制的实现方式。
